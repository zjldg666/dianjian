{"version":3,"file":"result.js","sources":["pages/result/result.vue","../../../../Download/HBuilder-alpha/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcmVzdWx0L3Jlc3VsdC52dWU"],"sourcesContent":["<template>\r\n  <view class=\"container\">\r\n    <navbar :username=\"username\" @logout=\"logout\"/>\r\n    <view class=\"content\">\r\n      <view v-if=\"loading\" class=\"loading\">\r\n        正在加载数据...\r\n      </view>\r\n      <view v-else-if=\"resultData && resultData.list.length > 0\">\r\n        <view class=\"header\">{{ resultData.list[0].Position }}</view>\r\n        <view class=\"detail-item\">\r\n          <text class=\"label\">点检项目:</text>\r\n          <text class=\"value\">{{ resultData.list[0].Project }}</text>\r\n        </view>\r\n        <view class=\"detail-item\">\r\n          <text class=\"label\">点检内容:</text>\r\n          <text class=\"value\">{{ resultData.list[0].Description }}</text>\r\n        </view>\r\n        <view class=\"detail-item\">\r\n          <text class=\"label\">点检结果:</text>\r\n          <text class=\"value\">\r\n            <span v-if=\"resultData.list[0].Result === '1'\"><image src=\"../../static/dui.png\" class=\"Fuhao\"></image></span> <!-- √ -->\r\n            <span v-else-if=\"resultData.list[0].Result === '3'\"><image src=\"../../static/NT.png\" class=\"Fuhao\"></image></span> <!-- ⊗ -->\r\n            <span v-else-if=\"resultData.list[0].Result === '2'\"><image src=\"../../static/cuo.png\" class=\"Fuhao\"></image></span> <!-- × -->\r\n          </text>\r\n        </view>\r\n        <view class=\"detail-item\">\r\n          <text class=\"label\">点检说明:</text>\r\n          <text class=\"value\">{{ resultData.list[0].Remark }}</text>\r\n        </view>\r\n        <view class=\"detail-item\">\r\n          <text class=\"label\">点检人:</text>\r\n          <text class=\"value\">{{ resultData.list[0].Person }}</text>\r\n        </view>\r\n        <view class=\"detail-item\">\r\n          <text class=\"label\">点检时间:</text>\r\n          <text class=\"value\">{{ resultData.list[0].Time1 }}</text>\r\n        </view>\r\n        <view class=\"detail-item\">\r\n          <text class=\"label\">设备时间:</text>\r\n          <text class=\"value\">{{ resultData.list[0].Time3 }}</text>\r\n        </view>\r\n        \r\n        <view class=\"images-container\">\r\n          <image \r\n            v-for=\"(image, index) in resultData.list[0].FileLists || []\" \r\n            :key=\"index\" \r\n            :src=\"'data:image/png;base64,' + image\" \r\n            class=\"image\"\r\n            @click=\"previewImage(index)\"\r\n          ></image>\r\n        </view>\r\n      </view>\r\n      <view v-else-if=\"!loading\" class=\"no-data\">\r\n        没有找到相关数据。\r\n      </view>\r\n    </view>\r\n    <image-viewer \r\n      :is-preview-visible=\"isPreviewVisible\" \r\n      :current-image=\"currentDetail?.FileLists[currentPreviewIndex] || ''\" \r\n      @update:is-preview-visible=\"isPreviewVisible = $event\"\r\n    />\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport Navbar from '@/components/Navbar.vue';\r\nimport ImageViewer from '@/components/ImageViewer.vue';\r\n\r\nexport default {\r\n  components: {\r\n    Navbar,\r\n    ImageViewer\r\n  },\r\n  data() {\r\n    return {\r\n      username: uni.getStorageSync('username') || '',\r\n      resultData: null,\r\n      loading: true,\r\n      isPreviewVisible: false,\r\n      currentPreviewIndex: 0\r\n    };\r\n  },\r\n  computed: {\r\n    currentDetail() {\r\n      return this.resultData ? this.resultData.list[0] : {};\r\n    }\r\n  },\r\n  methods: {\r\n    async fetchResult(position, project, description, time) {\r\n      try {\r\n        uni.showLoading({\r\n          title: '加载中...'\r\n        });\r\n\r\n        const token = uni.getStorageSync('token');\r\n        if (!token) {\r\n          uni.showToast({\r\n            title: '未登录，请先登录',\r\n            icon: 'none'\r\n          });\r\n          return;\r\n        }\r\n\r\n        const response = await uni.request({\r\n          url: 'http://13.94.38.44:8080/CheckList/GetScanReport3New',\r\n          method: 'POST',\r\n          data: {\r\n            token: token,\r\n            time: time,\r\n            Position: position,\r\n            Project: project,\r\n            Description: description\r\n          }\r\n        });\r\n\r\n       \r\n        const data = JSON.parse(response.data);\r\n        if (!data.isError) {\r\n          this.resultData = data;\r\n          console.log('更新状态成功:', this.resultData);\r\n        } else {\r\n          uni.showToast({\r\n            title: '更新状态失败',\r\n            icon: 'none'\r\n          });\r\n        }\r\n      } catch (error) {\r\n        console.error('更新状态失败', error);\r\n        uni.showToast({\r\n          title: '更新状态失败',\r\n          icon: 'none'\r\n        });\r\n      } finally {\r\n        uni.hideLoading();\r\n        this.loading = false;\r\n      }\r\n    },\r\n    logout() {\r\n      uni.removeStorageSync('username');\r\n      uni.redirectTo({\r\n        url: '/pages/login/login'\r\n      });\r\n    },\r\n    previewImage(index) {\r\n      this.currentPreviewIndex = index;\r\n      this.isPreviewVisible = true;\r\n    }\r\n  },\r\n  onLoad(options) {\r\n    const position = decodeURIComponent(options.position);\r\n    const project = decodeURIComponent(options.project);\r\n    const description = decodeURIComponent(options.description);\r\n    const time = decodeURIComponent(options.time);\r\n    if (position && project && description && time) {\r\n      this.fetchResult(position, project, description, time);\r\n    } else {\r\n      uni.showToast({\r\n        title: '缺少参数',\r\n        icon: 'none'\r\n      });\r\n      uni.navigateBack(); // 返回上一页\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style>\r\n.container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100vh;\r\n  background-color: white;\r\n}\r\n\r\n.content {\r\n  flex: 1;\r\n  padding: 40rpx;\r\n}\r\n\r\n.header {\r\n  font-size: 48rpx;\r\n  font-weight: bold;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.detail-item {\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.label {\r\n  font-weight: bold;\r\n  margin-right: 20rpx;\r\n}\r\n\r\n.images-container {\r\n  position: relative;\r\n  display: inline-block;\r\n  margin: 20rpx;\r\n}\r\n\r\n.image {\r\n  width: 160rpx;\r\n  height: 160rpx;\r\n  margin-right: 20rpx;\r\n  cursor: pointer;\r\n}\r\n\r\n.no-data {\r\n  margin-top: 40rpx;\r\n  font-size: 32rpx;\r\n  color: #888;\r\n}\r\n\r\n/* 图标样式 */\r\n.Fuhao {\r\n  width: 25rpx;\r\n  height: 25rpx;\r\n}\r\n\r\n.loading {\r\n  margin-top: 40rpx;\r\n  font-size: 32rpx;\r\n  color: #888;\r\n}\r\n</style>","import MiniProgramPage from 'D:/Project/HBuilderProjects/dianjianHmS/dianjian02/pages/result/result.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;;AAiEA,MAAK,SAAU,MAAW;AAC1B,oBAAoB,MAAW;AAE/B,MAAK,YAAU;AAAA,EACb,YAAY;AAAA,IACV;AAAA,IACA;AAAA,EACD;AAAA,EACD,OAAO;AACL,WAAO;AAAA,MACL,UAAUA,cAAG,MAAC,eAAe,UAAU,KAAK;AAAA,MAC5C,YAAY;AAAA,MACZ,SAAS;AAAA,MACT,kBAAkB;AAAA,MAClB,qBAAqB;AAAA;EAExB;AAAA,EACD,UAAU;AAAA,IACR,gBAAgB;AACd,aAAO,KAAK,aAAa,KAAK,WAAW,KAAK,CAAC,IAAI;IACrD;AAAA,EACD;AAAA,EACD,SAAS;AAAA,IACP,MAAM,YAAY,UAAU,SAAS,aAAa,MAAM;AACtD,UAAI;AACFA,sBAAAA,MAAI,YAAY;AAAA,UACd,OAAO;AAAA,QACT,CAAC;AAED,cAAM,QAAQA,cAAAA,MAAI,eAAe,OAAO;AACxC,YAAI,CAAC,OAAO;AACVA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO;AAAA,YACP,MAAM;AAAA,UACR,CAAC;AACD;AAAA,QACF;AAEA,cAAM,WAAW,MAAMA,cAAG,MAAC,QAAQ;AAAA,UACjC,KAAK;AAAA,UACL,QAAQ;AAAA,UACR,MAAM;AAAA,YACJ;AAAA,YACA;AAAA,YACA,UAAU;AAAA,YACV,SAAS;AAAA,YACT,aAAa;AAAA,UACf;AAAA,QACF,CAAC;AAGD,cAAM,OAAO,KAAK,MAAM,SAAS,IAAI;AACrC,YAAI,CAAC,KAAK,SAAS;AACjB,eAAK,aAAa;AAClBA,wBAAA,MAAA,MAAA,OAAA,kCAAY,WAAW,KAAK,UAAU;AAAA,eACjC;AACLA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO;AAAA,YACP,MAAM;AAAA,UACR,CAAC;AAAA,QACH;AAAA,MACA,SAAO,OAAO;AACdA,sBAAA,MAAA,MAAA,SAAA,kCAAc,UAAU,KAAK;AAC7BA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACR,CAAC;AAAA,MACH,UAAU;AACRA,sBAAG,MAAC,YAAW;AACf,aAAK,UAAU;AAAA,MACjB;AAAA,IACD;AAAA,IACD,SAAS;AACPA,0BAAI,kBAAkB,UAAU;AAChCA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK;AAAA,MACP,CAAC;AAAA,IACF;AAAA,IACD,aAAa,OAAO;AAClB,WAAK,sBAAsB;AAC3B,WAAK,mBAAmB;AAAA,IAC1B;AAAA,EACD;AAAA,EACD,OAAO,SAAS;AACd,UAAM,WAAW,mBAAmB,QAAQ,QAAQ;AACpD,UAAM,UAAU,mBAAmB,QAAQ,OAAO;AAClD,UAAM,cAAc,mBAAmB,QAAQ,WAAW;AAC1D,UAAM,OAAO,mBAAmB,QAAQ,IAAI;AAC5C,QAAI,YAAY,WAAW,eAAe,MAAM;AAC9C,WAAK,YAAY,UAAU,SAAS,aAAa,IAAI;AAAA,WAChD;AACLA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,MAAM;AAAA,MACR,CAAC;AACDA,oBAAG,MAAC,aAAY;AAAA,IAClB;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClKA,GAAG,WAAW,eAAe;"}