{"version":3,"file":"inspection.js","sources":["pages/inspection/inspection.vue","../../../../Download/HBuilder-alpha/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvaW5zcGVjdGlvbi9pbnNwZWN0aW9uLnZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"container\">\r\n    <navbar :username=\"username\" @logout=\"logout\"/>\r\n    <view class=\"content\">\r\n      <!-- 使用 ButtonGroup 组件 -->\r\n      <button-group :buttons=\"buttons\"/>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport Navbar from '@/components/Navbar.vue';\r\nimport ButtonGroup from '@/components/ButtonGroup.vue';\r\nimport { scanAndNavigate } from '@/utils/scanAndNavigate.js';\r\n\r\nexport default {\r\n  components: {\r\n    Navbar,\r\n    ButtonGroup\r\n  },\r\n  data() {\r\n    return {\r\n      username: uni.getStorageSync('username') || '',\r\n      buttons: [] // 用于存储点检项目的按钮数据\r\n    };\r\n  },\r\n  onLoad() {\r\n    // 获取对应的点检项目\r\n    this.getInspectionItems();\r\n  },\r\n  onPullDownRefresh() {\r\n    // 处理下拉刷新\r\n    this.getInspectionItems(() => {\r\n      uni.stopPullDownRefresh(); // 停止下拉刷新动作\r\n    });\r\n  },\r\n  methods: {\r\n    getInspectionItems(callback) {\r\n      const token = uni.getStorageSync('token'); // 从本地存储获取 token\r\n      const clientCode = uni.getStorageSync('clientcode'); // 从本地存储获取客户编码\r\n      uni.request({\r\n        url: 'http://13.94.38.44:8080/CheckList/GetAllCheckListByClientCode',\r\n        method: 'POST',\r\n        data: {\r\n          code: clientCode, // 使用存储的客户编码\r\n          token: token\r\n        },\r\n        success: (res) => {\r\n          const data = JSON.parse(res.data); // 解析 JSON 数据\r\n          console.log(\"token:\", token);\r\n          if (!data.isError) {\r\n            // 解析返回的数据，并生成按钮数据\r\n            this.buttons = data.list.map(item => ({\r\n              label: item.SEL_ShuoMing,\r\n              action: () => scanAndNavigate(item,this.loadInspectionDetails),\r\n\t\t\t  image:'../../static/icon/DJxiangmu.png'\r\n            }));\r\n            console.log('点检项目加载成功:', this.buttons);\r\n          } else {\r\n            console.error('加载点检项目失败:', data.message);\r\n          }\r\n          if (callback) callback(); // 停止刷新动作\r\n        },\r\n        fail: (err) => {\r\n          console.error('加载点检项目失败', err);\r\n          if (callback) callback(); // 停止刷新动作\r\n        }\r\n      });\r\n    },\r\n\tloadInspectionDetails(code, position) {\r\n\t  const token = uni.getStorageSync('token'); // 获取存储的 token\r\n\t  uni.request({\r\n\t    url: 'http://13.94.38.44:8080/CheckList/GetCheckListDetailNew',\r\n\t    method: 'POST',\r\n\t    data: {\r\n\t      code: code,\r\n\t      token: token\r\n\t    },\r\n\t    success: (res) => {\r\n\t      const data = JSON.parse(res.data); // 解析 JSON 数据\r\n\t      if (!data.isError) {\r\n\t        const inspectionDetails = data.dt; // 存储点检详情数据\r\n\t        console.log('点检详情加载成功:', inspectionDetails);\r\n\t        // 跳转到 project 页面，传递检点项目和名称\r\n\t        uni.navigateTo({\r\n\t          url: `/pages/project/project?id=${encodeURIComponent(code)}&name=${position.SEL_ShuoMing}`\r\n\t        });\r\n\t        console.log(encodeURIComponent(code));\r\n\t      } else {\r\n\t        console.error('加载点检详情失败:', data.msg);\r\n\t        uni.showToast({\r\n\t          title: data.msg,\r\n\t          icon: 'none'\r\n\t        });\r\n\t      }\r\n\t    },\r\n\t    fail: (err) => {\r\n\t      console.error('加载点检详情失败', err);\r\n\t    }\r\n\t  });\r\n\t},\r\n    logout() {\r\n      uni.removeStorageSync('username');\r\n      uni.redirectTo({\r\n        url: '/pages/login/login'\r\n      });\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n/* 容器样式 */\r\n.container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100vh;\r\n  background-color: white;\r\n}\r\n/* 内容样式 */\r\n.content {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  padding: 40rpx;\r\n}\r\n/* 标题样式 */\r\n.title {\r\n  font-size: 48rpx;\r\n  margin-bottom: 40rpx;\r\n  color: #fff;\r\n}\r\n</style>","import MiniProgramPage from 'D:/Project/HBuilderProjects/dianjianHmS/dianjian02/pages/inspection/inspection.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","scanAndNavigate"],"mappings":";;;AAWA,MAAK,SAAU,MAAW;AAC1B,oBAAoB,MAAW;AAG/B,MAAK,YAAU;AAAA,EACb,YAAY;AAAA,IACV;AAAA,IACA;AAAA,EACD;AAAA,EACD,OAAO;AACL,WAAO;AAAA,MACL,UAAUA,cAAG,MAAC,eAAe,UAAU,KAAK;AAAA,MAC5C,SAAS,CAAC;AAAA;AAAA;EAEb;AAAA,EACD,SAAS;AAEP,SAAK,mBAAkB;AAAA,EACxB;AAAA,EACD,oBAAoB;AAElB,SAAK,mBAAmB,MAAM;AAC5BA,oBAAG,MAAC,oBAAmB;AAAA,IACzB,CAAC;AAAA,EACF;AAAA,EACD,SAAS;AAAA,IACP,mBAAmB,UAAU;AAC3B,YAAM,QAAQA,cAAAA,MAAI,eAAe,OAAO;AACxC,YAAM,aAAaA,cAAAA,MAAI,eAAe,YAAY;AAClDA,oBAAAA,MAAI,QAAQ;AAAA,QACV,KAAK;AAAA,QACL,QAAQ;AAAA,QACR,MAAM;AAAA,UACJ,MAAM;AAAA;AAAA,UACN;AAAA,QACD;AAAA,QACD,SAAS,CAAC,QAAQ;AAChB,gBAAM,OAAO,KAAK,MAAM,IAAI,IAAI;AAChCA,wBAAY,MAAA,MAAA,OAAA,yCAAA,UAAU,KAAK;AAC3B,cAAI,CAAC,KAAK,SAAS;AAEjB,iBAAK,UAAU,KAAK,KAAK,IAAI,WAAS;AAAA,cACpC,OAAO,KAAK;AAAA,cACZ,QAAQ,MAAMC,sBAAe,gBAAC,MAAK,KAAK,qBAAqB;AAAA,cACtE,OAAM;AAAA,YACE,EAAC;AACFD,0BAAY,MAAA,MAAA,OAAA,yCAAA,aAAa,KAAK,OAAO;AAAA,iBAChC;AACLA,0BAAc,MAAA,MAAA,SAAA,yCAAA,aAAa,KAAK,OAAO;AAAA,UACzC;AACA,cAAI;AAAU;QACf;AAAA,QACD,MAAM,CAAC,QAAQ;AACbA,wBAAc,MAAA,MAAA,SAAA,yCAAA,YAAY,GAAG;AAC7B,cAAI;AAAU;QAChB;AAAA,MACF,CAAC;AAAA,IACF;AAAA,IACJ,sBAAsB,MAAM,UAAU;AACpC,YAAM,QAAQA,cAAAA,MAAI,eAAe,OAAO;AACxCA,oBAAAA,MAAI,QAAQ;AAAA,QACV,KAAK;AAAA,QACL,QAAQ;AAAA,QACR,MAAM;AAAA,UACJ;AAAA,UACA;AAAA,QACD;AAAA,QACD,SAAS,CAAC,QAAQ;AAChB,gBAAM,OAAO,KAAK,MAAM,IAAI,IAAI;AAChC,cAAI,CAAC,KAAK,SAAS;AACjB,kBAAM,oBAAoB,KAAK;AAC/BA,0BAAA,MAAA,MAAA,OAAA,yCAAY,aAAa,iBAAiB;AAE1CA,0BAAAA,MAAI,WAAW;AAAA,cACb,KAAK,6BAA6B,mBAAmB,IAAI,CAAC,SAAS,SAAS,YAAY;AAAA,YAC1F,CAAC;AACDA,0BAAA,MAAA,MAAA,OAAA,yCAAY,mBAAmB,IAAI,CAAC;AAAA,iBAC/B;AACLA,0BAAA,MAAA,MAAA,SAAA,yCAAc,aAAa,KAAK,GAAG;AACnCA,0BAAAA,MAAI,UAAU;AAAA,cACZ,OAAO,KAAK;AAAA,cACZ,MAAM;AAAA,YACR,CAAC;AAAA,UACH;AAAA,QACD;AAAA,QACD,MAAM,CAAC,QAAQ;AACbA,wBAAc,MAAA,MAAA,SAAA,yCAAA,YAAY,GAAG;AAAA,QAC/B;AAAA,MACF,CAAC;AAAA,IACF;AAAA,IACE,SAAS;AACPA,0BAAI,kBAAkB,UAAU;AAChCA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK;AAAA,MACP,CAAC;AAAA,IACH;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;AC3GA,GAAG,WAAW,eAAe;"}