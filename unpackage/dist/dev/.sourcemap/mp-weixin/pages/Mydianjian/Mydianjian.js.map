{"version":3,"file":"Mydianjian.js","sources":["pages/Mydianjian/Mydianjian.vue","../../../../Download/HBuilder-alpha/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvTXlkaWFuamlhbi9NeWRpYW5qaWFuLnZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"container\">\r\n    <!-- 导航栏组件 -->\r\n    <navbar :username=\"username\" @logout=\"logout\"/>\r\n    <view class=\"content\">\r\n      <!-- 按钮组组件 -->\r\n      <button-group :buttons=\"inspectionButtons\"/>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport Navbar from '@/components/Navbar.vue';\r\nimport ButtonGroup from '@/components/ButtonGroup.vue';\r\nimport { scanAndNavigate } from '@/utils/scanAndNavigate.js';\r\n\r\nexport default {\r\n  components: {\r\n    Navbar,\r\n    ButtonGroup\r\n  },\r\n  data() {\r\n    return {\r\n      username: uni.getStorageSync('username') || '',\r\n      positions: [], // 存储点检位置数据\r\n      inspectionButtons: [] // 存储按钮组数据\r\n    };\r\n  },\r\n  onLoad() {\r\n    this.fetchPositions();\r\n  },\r\n  methods: {\r\n    fetchPositions() {\r\n      const token = uni.getStorageSync('token'); // 获取存储的 token\r\n      uni.request({\r\n        url: 'http://13.94.38.44:8080/CheckList/GetPositionByPerson',\r\n        method: 'POST',\r\n        data: {\r\n          token: token\r\n        },\r\n        success: (res) => {\r\n          const data = JSON.parse(res.data); // 解析 JSON 数据\r\n          if (!data.isError) {\r\n            this.positions = data.list; // 存储点检位置数据\r\n            console.log('点检位置加载成功:', this.positions);\r\n            this.createInspectionButtons();\r\n          } else {\r\n            console.error('加载点检位置失败:', data.message);\r\n          }\r\n        },\r\n        fail: (err) => {\r\n          console.error('加载点检位置失败', err);\r\n        }\r\n      });\r\n    },\r\n    createInspectionButtons() {\r\n      this.inspectionButtons = this.positions.map(position => ({\r\n        label: position.SEL_ShuoMing,\r\n        action: () => scanAndNavigate(position, this.loadInspectionDetails),\r\n        disabled: false,\r\n\t\timage:'../../static/icon/DJxiangmu.png'\r\n      }));\r\n    },\r\n    loadInspectionDetails(code, position) {\r\n      const token = uni.getStorageSync('token'); // 获取存储的 token\r\n      uni.request({\r\n        url: 'http://13.94.38.44:8080/CheckList/GetCheckListDetailNew',\r\n        method: 'POST',\r\n        data: {\r\n          code: code,\r\n          token: token\r\n        },\r\n        success: (res) => {\r\n          const data = JSON.parse(res.data); // 解析 JSON 数据\r\n          if (!data.isError) {\r\n            const inspectionDetails = data.dt; // 存储点检详情数据\r\n            console.log('点检详情加载成功:', inspectionDetails);\r\n            // 跳转到 project 页面，传递检点项目和名称\r\n            uni.navigateTo({\r\n              url: `/pages/project/project?id=${encodeURIComponent(code)}&name=${position.SEL_ShuoMing}`\r\n            });\r\n            console.log(encodeURIComponent(code));\r\n          } else {\r\n            console.error('加载点检详情失败:', data.msg);\r\n            uni.showToast({\r\n              title: data.msg,\r\n              icon: 'none'\r\n            });\r\n          }\r\n        },\r\n        fail: (err) => {\r\n          console.error('加载点检详情失败', err);\r\n        }\r\n      });\r\n    },\r\n    logout() {\r\n      uni.removeStorageSync('username');\r\n      uni.redirectTo({\r\n        url: '/pages/login/login'\r\n      });\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n/* 样式部分保持不变 */\r\n.container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100vh;\r\n  background-color: white;\r\n}\r\n.content {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  padding: 40rpx;\r\n}\r\n</style>","import MiniProgramPage from 'D:/Project/HBuilderProjects/dianjianHmS/dianjian02/pages/Mydianjian/Mydianjian.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","scanAndNavigate"],"mappings":";;;AAYA,MAAK,SAAU,MAAW;AAC1B,oBAAoB,MAAW;AAG/B,MAAK,YAAU;AAAA,EACb,YAAY;AAAA,IACV;AAAA,IACA;AAAA,EACD;AAAA,EACD,OAAO;AACL,WAAO;AAAA,MACL,UAAUA,cAAG,MAAC,eAAe,UAAU,KAAK;AAAA,MAC5C,WAAW,CAAE;AAAA;AAAA,MACb,mBAAmB,CAAG;AAAA;AAAA;EAEzB;AAAA,EACD,SAAS;AACP,SAAK,eAAc;AAAA,EACpB;AAAA,EACD,SAAS;AAAA,IACP,iBAAiB;AACf,YAAM,QAAQA,cAAAA,MAAI,eAAe,OAAO;AACxCA,oBAAAA,MAAI,QAAQ;AAAA,QACV,KAAK;AAAA,QACL,QAAQ;AAAA,QACR,MAAM;AAAA,UACJ;AAAA,QACD;AAAA,QACD,SAAS,CAAC,QAAQ;AAChB,gBAAM,OAAO,KAAK,MAAM,IAAI,IAAI;AAChC,cAAI,CAAC,KAAK,SAAS;AACjB,iBAAK,YAAY,KAAK;AACtBA,sFAAY,aAAa,KAAK,SAAS;AACvC,iBAAK,wBAAuB;AAAA,iBACvB;AACLA,0BAAc,MAAA,MAAA,SAAA,yCAAA,aAAa,KAAK,OAAO;AAAA,UACzC;AAAA,QACD;AAAA,QACD,MAAM,CAAC,QAAQ;AACbA,wBAAc,MAAA,MAAA,SAAA,yCAAA,YAAY,GAAG;AAAA,QAC/B;AAAA,MACF,CAAC;AAAA,IACF;AAAA,IACD,0BAA0B;AACxB,WAAK,oBAAoB,KAAK,UAAU,IAAI,eAAa;AAAA,QACvD,OAAO,SAAS;AAAA,QAChB,QAAQ,MAAMC,sBAAe,gBAAC,UAAU,KAAK,qBAAqB;AAAA,QAClE,UAAU;AAAA,QAChB,OAAM;AAAA,MACD,EAAC;AAAA,IACH;AAAA,IACD,sBAAsB,MAAM,UAAU;AACpC,YAAM,QAAQD,cAAAA,MAAI,eAAe,OAAO;AACxCA,oBAAAA,MAAI,QAAQ;AAAA,QACV,KAAK;AAAA,QACL,QAAQ;AAAA,QACR,MAAM;AAAA,UACJ;AAAA,UACA;AAAA,QACD;AAAA,QACD,SAAS,CAAC,QAAQ;AAChB,gBAAM,OAAO,KAAK,MAAM,IAAI,IAAI;AAChC,cAAI,CAAC,KAAK,SAAS;AACjB,kBAAM,oBAAoB,KAAK;AAC/BA,0BAAY,MAAA,MAAA,OAAA,yCAAA,aAAa,iBAAiB;AAE1CA,0BAAAA,MAAI,WAAW;AAAA,cACb,KAAK,6BAA6B,mBAAmB,IAAI,CAAC,SAAS,SAAS,YAAY;AAAA,YAC1F,CAAC;AACDA,0BAAY,MAAA,MAAA,OAAA,yCAAA,mBAAmB,IAAI,CAAC;AAAA,iBAC/B;AACLA,0BAAA,MAAA,MAAA,SAAA,yCAAc,aAAa,KAAK,GAAG;AACnCA,0BAAAA,MAAI,UAAU;AAAA,cACZ,OAAO,KAAK;AAAA,cACZ,MAAM;AAAA,YACR,CAAC;AAAA,UACH;AAAA,QACD;AAAA,QACD,MAAM,CAAC,QAAQ;AACbA,wBAAc,MAAA,MAAA,SAAA,yCAAA,YAAY,GAAG;AAAA,QAC/B;AAAA,MACF,CAAC;AAAA,IACF;AAAA,IACD,SAAS;AACPA,0BAAI,kBAAkB,UAAU;AAChCA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK;AAAA,MACP,CAAC;AAAA,IACH;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;ACrGA,GAAG,WAAW,eAAe;"}