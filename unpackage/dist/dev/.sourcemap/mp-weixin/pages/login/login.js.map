{"version":3,"file":"login.js","sources":["pages/login/login.vue","../../../../Download/HBuilder-alpha/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbG9naW4vbG9naW4udnVl"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <Navbar></Navbar>\n    <view class=\"login-box\">\n      <view class=\"title\">登录</view>\n      <!-- 选择客户编码 -->\n      <picker mode=\"selector\" :range=\"clientCodes\" @change=\"handleClientCodeChange\">\n        <view class=\"picker\">\n          {{ selectedClientCode || '选择客户编码' }}\n        </view>\n      </picker>\n      <!-- 用户名输入框 -->\n      <input type=\"text\" placeholder=\" 账号\" v-model=\"strAccount\" class=\"input\"/>\n      <!-- 密码输入框 -->\n      <input type=\"password\" placeholder=\"密码\" v-model=\"password\" class=\"input\"/>\n      <!-- 登录按钮 -->\n      <button @click=\"login\" class=\"button\">登录</button>\n    </view>\r\n\t<view class=\"email-box\">\r\n\t\t<view class=\"email\">如遇bug，请联系:2926348424@qq.com</view>\r\n\t</view>\n  </view>\n</template>\n\n<script>\n\timport Navbar from '@/components/Navbar.vue';\r\n\timport checkUpdate from '@/uni_modules/uni-upgrade-center-app/utils/check-update';\nexport default {\n components: {\n    Navbar,\n  },\r\n  onReady() {\r\n  \t\t    // App 启动后立即检查更新\r\n  \t\t    checkUpdate()\r\n  \t\t  },\n  data() {\n    return {\n      strAccount: '', // 用户输入的账号\n      password: '', // 用户输入的密码\n      clientCodes: [], // 客户编码列表\n      selectedClientCode: '' // 选中的客户编码\n    };\n  },\n  onLoad() {\n    // 加载客户编码数据\n    this.loadClientCodes();\n  },\n  methods: {\n    loadClientCodes() {\n      uni.request({\n        url: 'http://13.94.38.44:8080/CheckList/GetClientCode', // 请求客户编码接口\n        method: 'GET',\n\t\tsuccess: (res) => {\n          const data = JSON.parse(res.data);\n          if (data && data.list) { // 检查 data 和 data.list 是否存在\n            this.clientCodes = data.list.map(item => item.ClientCode); // 解析客户编码列表\n            console.log('加载成功:', this.clientCodes);\n          } else {\n            console.error('加载客户编码失败:', data ? data.message : '无效的返回数据');\n          }\n        },\n        fail: (err) => {\n          console.error('加载客户编码失败', err);\n        }\n      });\n    },\n    handleClientCodeChange(event) {\n      // 处理客户编码选择事件\n      this.selectedClientCode = this.clientCodes[event.detail.value];\n    },\n    login() {\n      if (this.strAccount && this.password && this.selectedClientCode) {\n        uni.request({\n          url: 'http://13.94.38.44:8080/CheckList/SignIn', // 登录验证接口\n          method: 'POST',\n          data: {\n            strAccount: this.strAccount,\n            strPswd: this.password,\n            clientcode: this.selectedClientCode\n          },\n          success: (res) => {\n\t\t\t  \n            const data = JSON.parse(res.data);\n\t\t\tconsole.log(\"数据为:\",data);\n            if (data.IsError === false) {\n\t\t\t\t\n              uni.setStorageSync('token', data.token); // 存储token\n              uni.setStorageSync('username', data.userName); // 存储用户名\n              uni.setStorageSync('clientcode',this.selectedClientCode);\n\t\t\t  console.log(data.token);\n\t\t\t  uni.showToast({\n                title: '登录成功',\n                icon: 'success'\n              });\n              uni.redirectTo({\n                url: '/pages/home/home' // 跳转到主页\n              });\n            } else {\n              uni.showToast({\n                title: '用户名或密码错误',\n                icon: 'none'\n              });\n            }\n          },\n          fail: (err) => {\n            console.error('登录失败', err);\n            uni.showToast({\n              title: '登录失败，请稍后重试',\n              icon: 'none'\n            });\n          }\n        });\n      } else {\n        uni.showToast({\n          title: '请输入完整的登录信息',\n          icon: 'none',\n\t\t  complete:()=>{\n\t\t\t  uni.reLaunch({\n\t\t\t  \turl:'/pages/login/login'\n\t\t\t  });\n\t\t  }\n        });\n      }\n    }\n  }\n}\n</script>\n\n<style>\n.container {\n  display: flex;\n  flex-direction: column; /* 垂直排列 */\n  align-items: center; /* 水平居中 */\n  min-height: 100vh; /* 使用最小高度而非固定高度 */\n  background-color: #f5f5f5;\n  padding-top: 0; /* 移除顶部默认间距 */\n}\n.login-box {\n  width: 600rpx;\n  padding: 40rpx;\n  background-color: #fff;\n  box-shadow: 0 0 20rpx rgba(0,0,0,0.1);\n  border-radius: 20rpx;\n  margin-top: 250rpx; /* 增加与导航栏的距离 */\n}\n.title {\n  font-size: 48rpx;\n  text-align: center;\n  margin-bottom: 40rpx;\n}\n.picker {\n  width: 95%;\n  padding: 20rpx;\n  margin-bottom: 30rpx;\n  border: 2rpx solid #ccc;\n  border-radius: 10rpx;\n  text-align: center;\n}\n.input {\n  width: 95%;\n  padding: 20rpx;\n  margin-bottom: 30rpx;\n  border: 2rpx solid #ccc;\n  border-radius: 10rpx;\n}\n.button {\n  width: 100%;\n  padding: 20rpx;\n  background-color: #007aff;\n  color: #fff;\n  text-align: center;\n  border: none;\n  border-radius: 10rpx;\n  cursor: pointer;\n}\n.button:active {\n  background-color: #005bb5;\n}\r\n.email-box{\r\n\twidth: 600rpx;\r\n\tpadding: 40rpx;\r\n\tbackground-color: #fff;\r\n\tbox-shadow: 0 0 20rpx rgba(0,0,0,0.1);\r\n\tborder-radius: 20rpx;\r\n\tmargin-top: 300rpx;\r\n}\n</style>\n","import MiniProgramPage from 'D:/Project/HBuilderProjects/dianjianHmS/dianjian02/pages/login/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["checkUpdate","uni"],"mappings":";;;AAyBC,MAAK,SAAU,MAAW;AAE3B,MAAK,YAAU;AAAA,EACd,YAAY;AAAA,IACT;AAAA,EACD;AAAA,EACD,UAAU;AAEJA,kEAAY;AAAA,EACb;AAAA,EACL,OAAO;AACL,WAAO;AAAA,MACL,YAAY;AAAA;AAAA,MACZ,UAAU;AAAA;AAAA,MACV,aAAa,CAAE;AAAA;AAAA,MACf,oBAAoB;AAAA;AAAA;EAEvB;AAAA,EACD,SAAS;AAEP,SAAK,gBAAe;AAAA,EACrB;AAAA,EACD,SAAS;AAAA,IACP,kBAAkB;AAChBC,oBAAAA,MAAI,QAAQ;AAAA,QACV,KAAK;AAAA;AAAA,QACL,QAAQ;AAAA,QACd,SAAS,CAAC,QAAQ;AACV,gBAAM,OAAO,KAAK,MAAM,IAAI,IAAI;AAChC,cAAI,QAAQ,KAAK,MAAM;AACrB,iBAAK,cAAc,KAAK,KAAK,IAAI,UAAQ,KAAK,UAAU;AACxDA,0BAAY,MAAA,MAAA,OAAA,+BAAA,SAAS,KAAK,WAAW;AAAA,iBAChC;AACLA,gCAAc,MAAA,SAAA,+BAAA,aAAa,OAAO,KAAK,UAAU,SAAS;AAAA,UAC5D;AAAA,QACD;AAAA,QACD,MAAM,CAAC,QAAQ;AACbA,wBAAc,MAAA,MAAA,SAAA,+BAAA,YAAY,GAAG;AAAA,QAC/B;AAAA,MACF,CAAC;AAAA,IACF;AAAA,IACD,uBAAuB,OAAO;AAE5B,WAAK,qBAAqB,KAAK,YAAY,MAAM,OAAO,KAAK;AAAA,IAC9D;AAAA,IACD,QAAQ;AACN,UAAI,KAAK,cAAc,KAAK,YAAY,KAAK,oBAAoB;AAC/DA,sBAAAA,MAAI,QAAQ;AAAA,UACV,KAAK;AAAA;AAAA,UACL,QAAQ;AAAA,UACR,MAAM;AAAA,YACJ,YAAY,KAAK;AAAA,YACjB,SAAS,KAAK;AAAA,YACd,YAAY,KAAK;AAAA,UAClB;AAAA,UACD,SAAS,CAAC,QAAQ;AAEhB,kBAAM,OAAO,KAAK,MAAM,IAAI,IAAI;AACzCA,0BAAY,MAAA,MAAA,OAAA,+BAAA,QAAO,IAAI;AACd,gBAAI,KAAK,YAAY,OAAO;AAE1BA,4BAAAA,MAAI,eAAe,SAAS,KAAK,KAAK;AACtCA,4BAAAA,MAAI,eAAe,YAAY,KAAK,QAAQ;AAC5CA,4BAAAA,MAAI,eAAe,cAAa,KAAK,kBAAkB;AAChEA,4BAAA,MAAA,MAAA,OAAA,+BAAY,KAAK,KAAK;AACtBA,4BAAAA,MAAI,UAAU;AAAA,gBACH,OAAO;AAAA,gBACP,MAAM;AAAA,cACR,CAAC;AACDA,4BAAAA,MAAI,WAAW;AAAA,gBACb,KAAK;AAAA;AAAA,cACP,CAAC;AAAA,mBACI;AACLA,4BAAAA,MAAI,UAAU;AAAA,gBACZ,OAAO;AAAA,gBACP,MAAM;AAAA,cACR,CAAC;AAAA,YACH;AAAA,UACD;AAAA,UACD,MAAM,CAAC,QAAQ;AACbA,0BAAA,MAAA,MAAA,SAAA,gCAAc,QAAQ,GAAG;AACzBA,0BAAAA,MAAI,UAAU;AAAA,cACZ,OAAO;AAAA,cACP,MAAM;AAAA,YACR,CAAC;AAAA,UACH;AAAA,QACF,CAAC;AAAA,aACI;AACLA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,UACZ,UAAS,MAAI;AACZA,0BAAAA,MAAI,SAAS;AAAA,cACZ,KAAI;AAAA,YACL,CAAC;AAAA,UACF;AAAA,QACI,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;AC5HA,GAAG,WAAW,eAAe;"}