if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((n=>t.resolve(e()).then((()=>n))),(n=>t.resolve(e()).then((()=>{throw n}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function t(e,t,...n){uni.__log__?uni.__log__(e,t,...n):console[e].apply(console,[...n,t])}const n=(e,t)=>{const n=e.__vccOpts||e;for(const[a,i]of t)n[a]=i;return n};const a=n({data:()=>({companyList:[],selectedCompanyId:"",selectedCompanyName:"",username:"",password:""}),computed:{companyNames(){return this.companyList.map((e=>e.Name))}},onLoad(){this.fetchCompanyList()},methods:{fetchCompanyList(){uni.request({url:"http://13.94.38.44:8000/AssetsRepair/Index",method:"POST",success:e=>{const t=JSON.parse(e.data).list;this.companyList=t}})},onCompanyChange(e){const t=e.detail.value;this.selectedCompanyId=this.companyList[t].ID,this.selectedCompanyName=this.companyList[t].Name},login(){this.selectedCompanyId&&this.username&&this.password?uni.request({url:"http://13.94.38.44:8000/AssetsRepair/SignIn",method:"POST",header:{"content-type":"application/json"},data:JSON.stringify({connid:this.selectedCompanyId,strAccount:this.username,strPswd:this.password}),success:e=>{const n="string"==typeof e.data?JSON.parse(e.data):e.data;t("log","at pages/login/login.vue:76",n.token),t("log","at pages/login/login.vue:77",n),!1===n.IsError?(uni.setStorageSync("userInfo",{token:n.token,username:n.EMP_NAME,connid:n.connid}),uni.redirectTo({url:"/pages/home/home"})):(this.password="",n.message&&n.message.includes("账号或密码错误")?uni.showToast({title:"账号或密码错误",icon:"none"}):uni.showToast({title:n.message||"登录失败，请重试",icon:"none"}))},fail:()=>{this.password="",uni.showToast({title:"请求失败，请检查网络连接",icon:"none"})}}):uni.showToast({title:"请填写完整信息",icon:"none"})}}},[["render",function(t,n,a,i,s,o){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"login-box"},[e.createElementVNode("picker",{mode:"selector",range:o.companyNames,onChange:n[0]||(n[0]=(...e)=>o.onCompanyChange&&o.onCompanyChange(...e))},[e.createElementVNode("view",{class:"picker"}," 当前选择："+e.toDisplayString(s.selectedCompanyName?s.selectedCompanyName:"请选择公司"),1)],40,["range"]),e.withDirectives(e.createElementVNode("input",{type:"text",placeholder:"请输入用户名","onUpdate:modelValue":n[1]||(n[1]=e=>s.username=e),class:"input"},null,512),[[e.vModelText,s.username]]),e.withDirectives(e.createElementVNode("input",{type:"password",placeholder:"请输入密码","onUpdate:modelValue":n[2]||(n[2]=e=>s.password=e),class:"input"},null,512),[[e.vModelText,s.password]]),e.createElementVNode("button",{type:"primary",onClick:n[3]||(n[3]=(...e)=>o.login&&o.login(...e)),class:"button"},"登录")])])}]]);const i=n({props:{username:String}},[["render",function(t,n,a,i,s,o){return e.openBlock(),e.createElementBlock("view",{class:"navbar"},[e.createElementVNode("view",{class:"logoBox"},[e.createElementVNode("image",{class:"logo",src:"/static/logo.png",mode:"heightFix"})]),e.createElementVNode("view",{class:"username"},e.toDisplayString(a.username),1),e.createElementVNode("button",{onClick:n[0]||(n[0]=e=>t.$emit("logout")),class:"nabutton"},"退出")])}],["__scopeId","data-v-a07997eb"]]);const s=n({components:{Navbar:i},data:()=>({username:""}),onLoad(){const e=uni.getStorageSync("userInfo");e&&e.username&&(this.username=e.username)},methods:{scanAndNavigate(){uni.scanCode({success:e=>{const n=e.result;t("log","at pages/home/home.vue:76",n),this.navigateToRepair(n)},fail:()=>{uni.showToast({title:"扫码失败，请重试",icon:"none"})}})},navigateToRepair(e){const n=uni.getStorageSync("userInfo");t("log","at pages/home/home.vue:90",n.connid),n.token&&n.connid?uni.request({url:"http://13.94.38.44:8000/AssetsRepair/ShowNewInfo",method:"POST",header:{"content-type":"application/json"},data:JSON.stringify({connid:n.connid,token:n.token,AssetsCode:e,isEdit:!0}),success:e=>{const n="string"==typeof e.data?JSON.parse(e.data):e.data;t("log","at pages/home/home.vue:113",n),t("log","at pages/home/home.vue:114",n.AssetsCode),n.IsError?uni.showToast({title:"获取资产信息失败",icon:"none"}):uni.navigateTo({url:`/pages/repair/repair?data=${JSON.stringify(n)}`})},fail:()=>{uni.showToast({title:"请求失败，请检查网络连接",icon:"none"})}}):uni.showToast({title:"请先登录",icon:"none"})},TomobileRepair(){uni.navigateTo({url:"/pages/mobileRepair/mobileRepair"})},TorepairList(){uni.navigateTo({url:"/pages/repairList/repairList"})},navigateTo(e){uni.navigateTo({url:`/pages/${e}/${e}`})},logout(){uni.removeStorageSync("userInfo"),uni.redirectTo({url:"/pages/login/login"})}}},[["render",function(t,n,a,i,s,o){const r=e.resolveComponent("navbar");return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createVNode(r,{username:s.username,onLogout:o.logout},null,8,["username","onLogout"]),e.createElementVNode("view",{class:"button-group"},[e.createElementVNode("view",{class:"button-row"},[e.createElementVNode("button",{class:"square-button",onClick:n[0]||(n[0]=(...e)=>o.scanAndNavigate&&o.scanAndNavigate(...e))},[e.createElementVNode("view",{class:"icon-text-container"},[e.createElementVNode("image",{class:"icon",src:"/static/icon/SaomaBx.png"}),e.createElementVNode("text",{class:"text"},"扫码报修")])]),e.createElementVNode("button",{class:"square-button",onClick:n[1]||(n[1]=(...e)=>o.TomobileRepair&&o.TomobileRepair(...e))},[e.createElementVNode("view",{class:"icon-text-container"},[e.createElementVNode("image",{class:"icon",src:"/static/icon/ShoujiBx.png"}),e.createElementVNode("text",{class:"text"},"手机报修")])])]),e.createElementVNode("view",{class:"button-row"},[e.createElementVNode("button",{class:"square-button",onClick:n[2]||(n[2]=(...e)=>o.TorepairList&&o.TorepairList(...e))},[e.createElementVNode("view",{class:"icon-text-container"},[e.createElementVNode("image",{class:"icon",src:"/static/icon/bxQingdan.png"}),e.createElementVNode("text",{class:"text"},"报修清单")])]),e.createElementVNode("button",{class:"square-button",onClick:n[3]||(n[3]=e=>o.navigateTo("assetList"))},[e.createElementVNode("view",{class:"icon-text-container"},[e.createElementVNode("image",{class:"icon",src:"/static/icon/ZichanQingdan.png"}),e.createElementVNode("text",{class:"text"},"资产清单")])])]),e.createElementVNode("view",{class:"button-row"},[e.createElementVNode("button",{class:"square-button",onClick:n[4]||(n[4]=e=>o.navigateTo("simpleReport"))},[e.createElementVNode("view",{class:"icon-text-container"},[e.createElementVNode("image",{class:"icon",src:"/static/icon/EasyBaobiao.png"}),e.createElementVNode("text",{class:"text"},"简单报表")])]),e.createElementVNode("button",{class:"square-button empty-button"})])])])}],["__scopeId","data-v-15bf7d56"]]);const o=n({components:{Navbar:i},data:()=>({username:"",connid:"",token:"",docnum:"",AssetsCode:"",AssetsName:"",UserDept:"",AssetsType:"",FinishDate:"",Discription:"",images:[]}),onLoad(e){if(e.data){const n=JSON.parse(decodeURIComponent(e.data));t("log","at pages/repair/repair.vue:98",n),this.connid=n.connid,this.token=n.token,this.docnum=n.docnum,this.AssetsCode=n.AssetsCode,this.AssetsName=n.AssetsName,this.UserDept=n.UserDept||"",this.AssetsType=n.AssetsType;const a=uni.getStorageSync("repairDraft_"+this.AssetsCode);t("log","at pages/repair/repair.vue:109",a),a&&(this.FinishDate=a.FinishDate,this.Discription=a.Discription,this.images=a.images);const i=uni.getStorageSync("userInfo");i&&i.username&&(this.username=i.username)}},methods:{logout(){uni.removeStorageSync("userInfo"),uni.redirectTo({url:"/pages/login/login"})},onDateChange(e){this.FinishDate=e.detail.value},chooseImage(){uni.chooseImage({count:1,success:e=>{this.images.push(...e.tempFilePaths)}})},previewImage(e){uni.previewImage({current:e,urls:this.images})},removeImage(e){this.images.splice(e,1)},async showConfirmDialog(e){if(!this.FinishDate||!this.Discription)return void uni.showToast({title:"请确保所有必填项已填写",icon:"none"});await this.showModalAsync(`确定${e}报修吗？`)?"立即"===e?await this.submitRepair(!0):(await this.saveAsDraft(),uni.redirectTo({url:"/pages/home/home"})):t("log","at pages/repair/repair.vue:175","用户取消了操作")},showModalAsync:e=>new Promise((t=>{uni.showModal({title:"提示",content:e,success:e=>t(e.confirm),fail:()=>t(!1)})})),async submitRepair(e){try{const n=e?"1":"0",a=await Promise.all(this.images.map((e=>this.urlToBase64(e))));t("log","at pages/repair/repair.vue:194","Base64 Images:",a);const i={connid:this.connid,AssetsCode:this.AssetsCode,token:this.token,docnum:this.docnum,Discription:this.Discription,FinishDate:this.FinishDate,type:n,FileList:a};t("log","at pages/repair/repair.vue:207","请求数据:",i);t("log","at pages/repair/repair.vue:219","提交成功:",(await new Promise(((e,t)=>{uni.request({url:"http://13.94.38.44:8000/AssetsRepair/SaveNewInfo",method:"POST",data:i,success:e,fail:t})}))).data),uni.removeStorageSync("repairDraft_"+this.AssetsCode),uni.showToast({title:"提交成功",icon:"success",duration:2e3,complete:()=>{uni.redirectTo({url:"/pages/home/home"})}})}catch(n){t("error","at pages/repair/repair.vue:235","提交失败:",n),uni.showToast({title:"提交失败",icon:"none"})}},async saveAsDraft(){try{const e={connid:this.connid,token:this.token,docnum:this.docnum,AssetsCode:this.AssetsCode,AssetsName:this.AssetsName,UserDept:this.UserDept,AssetsType:this.AssetsType,FinishDate:this.FinishDate,Discription:this.Discription,images:this.images};t("log","at pages/repair/repair.vue:258","准备保存草稿:",e),uni.setStorageSync("repairDraft_"+this.AssetsCode,e),t("log","at pages/repair/repair.vue:262","草稿保存成功"),uni.showToast({title:"已保存为草稿",icon:"success",duration:2e3,complete:()=>{t("log","at pages/repair/repair.vue:269","提示框显示完毕，即将返回首页"),uni.redirectTo({url:"/pages/home/home"})}})}catch(e){t("error","at pages/repair/repair.vue:276","保存草稿失败:",e),uni.showToast({title:"保存草稿失败",icon:"none"})}},urlToBase64:(e,t="png")=>"string"!=typeof e||""===e.trim()?Promise.reject(new Error("Invalid URL")):new Promise(((n,a)=>{e.startsWith("http")?uni.request({url:e,method:"GET",responseType:"arraybuffer",success:e=>{const a=`data:image/${t};base64,${uni.arrayBufferToBase64(e.data)}`;n(a)},fail:e=>{a(new Error(`Request failed: ${e}`))}}):uni.compressImage({src:e,quality:100,success:e=>{const t=e.tempFilePath;plus.io.resolveLocalFileSystemURL(t,(e=>{e.file((e=>{let t=new plus.io.FileReader;t.onload=e=>{n(e.target.result)},t.readAsDataURL(e)}),(e=>{a(new Error(`File resolution failed: ${e}`))}))}),(e=>{a(new Error(`File resolution failed: ${e}`))}))},fail:e=>{a(new Error(`Compress image failed: ${e}`))}})}))}},[["render",function(t,n,a,i,s,o){const r=e.resolveComponent("navbar");return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createVNode(r,{username:s.username,onLogout:o.logout},null,8,["username","onLogout"]),e.createElementVNode("view",{class:"content"},[e.createElementVNode("form",{onSubmit:n[6]||(n[6]=(...e)=>o.submitRepair&&o.submitRepair(...e))},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",null,"报修单号:"),e.createElementVNode("input",{type:"text",value:s.docnum,disabled:"",class:"input"},null,8,["value"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",null,"资产编码:"),e.createElementVNode("input",{type:"text",value:s.AssetsCode,disabled:"",class:"input"},null,8,["value"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",null,"资产名称:"),e.createElementVNode("input",{type:"text",value:s.AssetsName,disabled:"",class:"input"},null,8,["value"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",null,"使用部门:"),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":n[0]||(n[0]=e=>s.UserDept=e),disabled:"",class:"input"},null,512),[[e.vModelText,s.UserDept]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",null,"资产类型:"),e.createElementVNode("input",{type:"text",value:s.AssetsType,disabled:"",class:"input"},null,8,["value"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",null,"完工日期:"),e.createElementVNode("picker",{mode:"date",onChange:n[1]||(n[1]=(...e)=>o.onDateChange&&o.onDateChange(...e)),class:"input"},[e.createElementVNode("view",null,e.toDisplayString(s.FinishDate||"请选择日期"),1)],32)]),e.createElementVNode("view",{class:"form-group"},[e.createElementVNode("text",null,"故障描述:"),e.withDirectives(e.createElementVNode("textarea",{"onUpdate:modelValue":n[2]||(n[2]=e=>s.Discription=e),placeholder:"请输入故障描述",class:"textarea"},null,512),[[e.vModelText,s.Discription]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",null,"上传照片"),e.createElementVNode("button",{onClick:n[3]||(n[3]=(...e)=>o.chooseImage&&o.chooseImage(...e)),class:"imageButton"},"+")]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.images,((t,n)=>(e.openBlock(),e.createElementBlock("view",{key:n,class:"image-preview"},[e.createElementVNode("image",{src:t,class:"preview-image",onClick:e=>o.previewImage(n),"data-index":n},null,8,["src","onClick","data-index"]),e.createElementVNode("button",{class:"delete-button",onClick:e.withModifiers((e=>o.removeImage(n)),["stop","prevent"])},"x",8,["onClick"])])))),128)),e.createElementVNode("view",{class:"button-row"},[e.createElementVNode("button",{type:"primary",onClick:n[4]||(n[4]=e=>o.showConfirmDialog("立即"))},"立即报修"),e.createElementVNode("button",{onClick:n[5]||(n[5]=e=>o.showConfirmDialog("稍后"))},"稍后报修")])],32)])])}],["__scopeId","data-v-c199ba06"]]);const r=n({props:{visible:{type:Boolean,required:!0},currentImage:{type:String,required:!0},onClose:{type:Function,required:!0}},methods:{closeViewer(){this.onClose()}}},[["render",function(t,n,a,i,s,o){return a.visible?(e.openBlock(),e.createElementBlock("view",{key:0,class:"image-viewer",onClick:n[1]||(n[1]=e.withModifiers(((...e)=>o.closeViewer&&o.closeViewer(...e)),["self"]))},[e.createElementVNode("view",{class:"close-btn",onClick:n[0]||(n[0]=e.withModifiers(((...e)=>o.closeViewer&&o.closeViewer(...e)),["stop"]))},"X"),e.createElementVNode("image",{src:a.currentImage,class:"preview-image"},null,8,["src"])])):e.createCommentVNode("",!0)}],["__scopeId","data-v-08b0f27f"]]);const l=n({components:{Navbar:i,ImageViewer:r},data:()=>({username:"",detail:{},currentTab:"baoxiu",isImageViewerVisible:!1,selectedImageUrl:""}),onLoad(e){const t=uni.getStorageSync("userInfo");t&&t.username&&(this.username=t.username),this.fetchDetail(e.docnum),this.fetchWeixiuDetail(e.docnum)},methods:{closeImageViewer(){this.isImageViewerVisible=!1},openImageViewer(e){this.selectedImageUrl=e,this.isImageViewerVisible=!0},logout(){uni.removeStorageSync("userInfo"),uni.redirectTo({url:"/pages/login/login"})},fetchDetail(e){const n=uni.getStorageSync("userInfo");n.token&&n.connid?uni.request({url:"http://13.94.38.44:8000/AssetsRepair/GetMainListDetail",method:"POST",header:{"content-type":"application/json"},data:JSON.stringify({connid:n.connid,token:n.token,docnum:e}),success:e=>{let n;try{n="string"==typeof e.data?JSON.parse(e.data):e.data}catch(a){return t("error","at pages/copy/copy.vue:163","解析响应数据失败:",a),void uni.showToast({title:"解析数据失败",icon:"none"})}n.isError?uni.showToast({title:"获取详细信息失败",icon:"none"}):this.detail={...this.detail,...n}},fail:()=>{uni.showToast({title:"请求失败，请检查网络连接",icon:"none"})}}):uni.showToast({title:"请先登录",icon:"none"})},fetchWeixiuDetail(e){const n=uni.getStorageSync("userInfo");n.token&&n.connid?uni.request({url:"http://13.94.38.44:8000/AssetsRepair/GetMainListDetail",method:"POST",header:{"content-type":"application/json"},data:JSON.stringify({connid:n.connid,token:n.token,docnum:e}),success:e=>{let n;try{n="string"==typeof e.data?JSON.parse(e.data):e.data}catch(a){return t("error","at pages/copy/copy.vue:215","解析响应数据失败:",a),void uni.showToast({title:"解析数据失败",icon:"none"})}n.isError?uni.showToast({title:"获取详细信息失败",icon:"none"}):this.detail={...this.detail,...n}},fail:()=>{uni.showToast({title:"请求失败，请检查网络连接",icon:"none"})}}):uni.showToast({title:"请先登录",icon:"none"})},switchTab(e){this.currentTab=e}}},[["render",function(t,n,a,i,s,o){const r=e.resolveComponent("navbar"),l=e.resolveComponent("image-viewer");return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createVNode(r,{username:s.username,onLogout:o.logout},null,8,["username","onLogout"]),e.createElementVNode("view",{class:"tabs"},[e.createElementVNode("view",{class:e.normalizeClass(["tab",{active:"baoxiu"===s.currentTab}]),onClick:n[0]||(n[0]=e=>o.switchTab("baoxiu"))}," 报修明细 ",2),e.createElementVNode("view",{class:e.normalizeClass(["tab",{active:"weixiu"===s.currentTab}]),onClick:n[1]||(n[1]=e=>o.switchTab("weixiu"))}," 维修明细 ",2)]),"baoxiu"===s.currentTab?(e.openBlock(),e.createElementBlock("view",{key:0,class:"content"},[e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"报修单号:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.docnum),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"报修单号:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.docnum),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"资产编号:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.AssetsCode),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"资产名称:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.AssetsName),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"使用部门:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.UserDep),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"资产类型:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.AssetsType),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"完工日期:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.FinishDate),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"故障描述:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.Discription),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"相关相片:")]),s.detail.FilesList&&s.detail.FilesList.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"image-preview"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.detail.FilesList,((t,n)=>(e.openBlock(),e.createElementBlock("view",{key:n},[e.createElementVNode("image",{src:t,mode:"aspectFit",class:"image",onClick:e=>o.openImageViewer(t)},null,8,["src","onClick"])])))),128))])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"no-images"},"暂无相关图片"))])):e.createCommentVNode("",!0),"weixiu"===s.currentTab?(e.openBlock(),e.createElementBlock("view",{key:1,class:"content"},[e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"维修单号:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.wxdocnum),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"维修单号:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.wxdocnum),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"原因分析:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.Reason),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"维修方案:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.SchemeTxt),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"预计金额:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.Amount),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"币别:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.Currency),1)])])):e.createCommentVNode("",!0),e.createVNode(l,{visible:s.isImageViewerVisible,"current-image":s.selectedImageUrl,"on-close":o.closeImageViewer},null,8,["visible","current-image","on-close"])])}],["__scopeId","data-v-b0cbc6dd"]]);const c=n({components:{Navbar:i},data:()=>({username:"",searchQuery:"",assetsList:[],selectedAsset:"",currentPage:1,pageSize:10,loading:!1,hasMoreData:!0}),computed:{filteredAssets(){return this.assetsList.filter((e=>e.资产编号&&e.资产编号.includes(this.searchQuery)||e.资产名称&&e.资产名称.includes(this.searchQuery))).slice(0,this.currentPage*this.pageSize)},selectedAssetInfo(){return this.assetsList.find((e=>e.资产编号===this.selectedAsset))}},onLoad(){const e=uni.getStorageSync("userInfo");e&&e.username&&(this.username=e.username),this.fetchAssets()},methods:{fetchAssets(e=!1){if(e&&(this.assetsList=[],this.currentPage=1,this.hasMoreData=!0),!this.hasMoreData||this.loading)return;this.loading=!0;const n=uni.getStorageSync("userInfo");if(!n.token||!n.connid)return uni.showToast({title:"请先登录",icon:"none"}),void(this.loading=!1);uni.request({url:"http://13.94.38.44:8000/AssetsRepair/GetAllCode",method:"POST",header:{"content-type":"application/json"},data:JSON.stringify({connid:n.connid,token:n.token,search:this.searchQuery,isEdit:!0,page:this.currentPage,size:this.pageSize}),success:n=>{const a="string"==typeof n.data?JSON.parse(n.data):n.data;t("log","at pages/mobileRepair/mobileRepair.vue:127",a),a.IsError?uni.showToast({title:"获取资产信息失败",icon:"none"}):a.list.length>0?(this.assetsList=e?a.list:[...this.assetsList,...a.list],this.currentPage++):this.hasMoreData=!1},fail:()=>{uni.showToast({title:"请求失败，请检查网络连接",icon:"none"})},complete:()=>{this.loading=!1}})},handleSearchInput(){this.fetchAssets(!0)},toggleSelection(e){this.selectedAsset===e.资产编号?this.selectedAsset="":this.selectedAsset=e.资产编号},submitRepair(){if(!this.selectedAsset)return void uni.showToast({title:"请选择一个资产",icon:"none"});const{"资产编号":e,"资产名称":n}=this.selectedAssetInfo;t("log","at pages/mobileRepair/mobileRepair.vue:176",this.selectedAssetInfo),uni.request({url:"http://13.94.38.44:8000/AssetsRepair/GetAssetsInfoByCode",method:"POST",header:{"content-type":"application/json"},data:JSON.stringify({connid:uni.getStorageSync("userInfo").connid,AssetsCode:e,token:uni.getStorageSync("userInfo").token}),success:e=>{const n="string"==typeof e.data?JSON.parse(e.data):e.data;t("log","at pages/mobileRepair/mobileRepair.vue:191",n),n.IsError?uni.showToast({title:"获取资产信息失败",icon:"none"}):uni.navigateTo({url:`/pages/repair/repair?data=${encodeURIComponent(JSON.stringify(n))}`})},fail:()=>{uni.showToast({title:"请求失败，请检查网络连接",icon:"none"})}})},loadMore(){this.fetchAssets()},logout(){uni.removeStorageSync("userInfo"),uni.redirectTo({url:"/pages/login/login"})}}},[["render",function(t,n,a,i,s,o){const r=e.resolveComponent("navbar");return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createVNode(r,{username:s.username,onLogout:o.logout},null,8,["username","onLogout"]),e.createElementVNode("view",{class:"content"},[e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":n[0]||(n[0]=e=>s.searchQuery=e),placeholder:"请输入搜索内容",onInput:n[1]||(n[1]=(...e)=>o.handleSearchInput&&o.handleSearchInput(...e)),class:"search-input"},null,544),[[e.vModelText,s.searchQuery]]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"table-container",onScrolltolower:n[2]||(n[2]=(...e)=>o.loadMore&&o.loadMore(...e))},[e.createElementVNode("view",{class:"table-header"},[e.createElementVNode("view",{class:"header-cell"},"选择"),e.createElementVNode("view",{class:"header-cell"},"资产编码"),e.createElementVNode("view",{class:"header-cell"},"资产名称")]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.filteredAssets,((t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["table-row",{selected:s.selectedAsset===t.资产编号}]),key:n,onClick:e=>o.toggleSelection(t)},[e.createElementVNode("view",{class:"cell"},[e.createElementVNode("view",{class:e.normalizeClass({"radio-checked":s.selectedAsset===t.资产编号,"radio-unchecked":s.selectedAsset!==t.资产编号})},null,2)]),e.createElementVNode("view",{class:"cell"},e.toDisplayString(t.资产编号),1),e.createElementVNode("view",{class:"cell"},e.toDisplayString(t.资产名称),1)],10,["onClick"])))),128)),s.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-indicator"},"加载中...")):e.createCommentVNode("",!0)],32),e.createElementVNode("button",{class:"repair-button",disabled:!s.selectedAsset,onClick:n[3]||(n[3]=(...e)=>o.submitRepair&&o.submitRepair(...e))}," 确定报修 ",8,["disabled"])])])}],["__scopeId","data-v-cd8036f1"]]);const d=n({components:{Navbar:i},data:()=>({username:"",assetsList:[],pagesize:10,currentPage:1,hasMoreData:!0,loading:!1,error:!1}),onLoad(){const e=uni.getStorageSync("userInfo");e&&e.username&&(this.username=e.username),this.fetchAssets()},methods:{fetchAssets(e=!1){e&&(this.assetsList=[],this.currentPage=1,this.hasMoreData=!0,this.error=!1);const n=uni.getStorageSync("userInfo");t("log","at pages/repairList/repairList.vue:73",n),n.token&&n.connid?(this.loading=!0,uni.request({url:"http://13.94.38.44:8000/AssetsRepair/GetMainList",method:"POST",header:{"content-type":"application/json"},data:JSON.stringify({connid:n.connid,token:n.token}),success:n=>{let a;try{a="string"==typeof n.data?JSON.parse(n.data):n.data}catch(i){return t("error","at pages/repairList/repairList.vue:100","解析响应数据失败:",i),uni.showToast({title:"解析数据失败",icon:"none"}),this.loading=!1,void(this.error=!0)}t("log","at pages/repairList/repairList.vue:110",a),!a.IsError&&a.list?Array.isArray(a.list)&&a.list.length>0?(this.assetsList=e?a.list:[...this.assetsList,...a.list],this.currentPage++):this.hasMoreData=!1:(uni.showToast({title:"获取资产信息失败",icon:"none"}),this.error=!0)},fail:()=>{uni.showToast({title:"请求失败，请检查网络连接",icon:"none"}),this.error=!0},complete:()=>{this.loading=!1}})):uni.showToast({title:"请先登录",icon:"none"})},navigateToDetail(e){e.进度&&uni.navigateTo({url:`/pages/baoxiuMIngxi/baoxiuMIngxi?docnum=${e.报修单号}`})},logout(){uni.removeStorageSync("userInfo"),uni.redirectTo({url:"/pages/login/login"})}}},[["render",function(t,n,a,i,s,o){const r=e.resolveComponent("navbar");return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createVNode(r,{username:s.username,onLogout:o.logout},null,8,["username","onLogout"]),e.createElementVNode("view",{class:"content"},[e.createElementVNode("scroll-view",{"scroll-y":"",class:"table-container"},[e.createElementVNode("view",{class:"table-header"},[e.createElementVNode("view",{class:"header-cell"},"进度"),e.createElementVNode("view",{class:"header-cell"},"报修单号"),e.createElementVNode("view",{class:"header-cell"},"资产名称"),e.createElementVNode("view",{class:"header-cell"},"故障描述")]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.assetsList,((t,n)=>(e.openBlock(),e.createElementBlock("view",{class:"table-row",key:n,onClick:e=>o.navigateToDetail(t)},[e.createElementVNode("view",{class:"cell"},e.toDisplayString(t.进度||"-"),1),e.createElementVNode("view",{class:"cell"},e.toDisplayString(t.报修单号||"-"),1),e.createElementVNode("view",{class:"cell"},e.toDisplayString(t.资产名称||"-"),1),e.createElementVNode("view",{class:"cell"},e.toDisplayString(t.故障描述||"-"),1)],8,["onClick"])))),128)),s.assetsList.length||s.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"no-data"},"暂无数据")),s.loading?(e.openBlock(),e.createElementBlock("view",{key:1,class:"loading-indicator"},"加载中...")):e.createCommentVNode("",!0),s.error?(e.openBlock(),e.createElementBlock("view",{key:2,class:"error-message"},[e.createTextVNode(" 数据加载失败，请尝试刷新。"),e.createElementVNode("button",{class:"refresh-button",onClick:n[0]||(n[0]=e=>o.fetchAssets(!0))},"刷新")])):e.createCommentVNode("",!0)])])])}],["__scopeId","data-v-d2ebc7f9"]]);const u=n({components:{Navbar:i,ImageViewer:r},data:()=>({username:"",detail:{},currentTab:"baoxiu",isImageViewerVisible:!1,selectedImageUrl:""}),onLoad(e){const t=uni.getStorageSync("userInfo");t&&t.username&&(this.username=t.username),this.fetchDetail(e.docnum),this.fetchWeixiuDetail(e.docnum)},methods:{closeImageViewer(){this.isImageViewerVisible=!1},openImageViewer(e){this.selectedImageUrl=e,this.isImageViewerVisible=!0},logout(){uni.removeStorageSync("userInfo"),uni.redirectTo({url:"/pages/login/login"})},fetchDetail(e){const n=uni.getStorageSync("userInfo");n.token&&n.connid?uni.request({url:"http://13.94.38.44:8000/AssetsRepair/GetMainListDetail",method:"POST",header:{"content-type":"application/json"},data:JSON.stringify({connid:n.connid,token:n.token,docnum:e}),success:e=>{let n;try{n="string"==typeof e.data?JSON.parse(e.data):e.data,t("log","at pages/baoxiuMIngxi/baoxiuMIngxi.vue:156",n)}catch(a){return t("error","at pages/baoxiuMIngxi/baoxiuMIngxi.vue:158","解析响应数据失败:",a),void uni.showToast({title:"解析数据失败",icon:"none"})}n.isError?uni.showToast({title:"获取详细信息失败",icon:"none"}):this.detail={...this.detail,...n}},fail:()=>{uni.showToast({title:"请求失败，请检查网络连接",icon:"none"})}}):uni.showToast({title:"请先登录",icon:"none"})},fetchWeixiuDetail(e){const n=uni.getStorageSync("userInfo");n.token&&n.connid?uni.request({url:"http://13.94.38.44:8000/AssetsRepair/GetMainListDetail",method:"POST",header:{"content-type":"application/json"},data:JSON.stringify({connid:n.connid,token:n.token,docnum:e}),success:e=>{let n;try{n="string"==typeof e.data?JSON.parse(e.data):e.data}catch(a){return t("error","at pages/baoxiuMIngxi/baoxiuMIngxi.vue:210","解析响应数据失败:",a),void uni.showToast({title:"解析数据失败",icon:"none"})}n.isError?uni.showToast({title:"获取详细信息失败",icon:"none"}):this.detail={...this.detail,...n}},fail:()=>{uni.showToast({title:"请求失败，请检查网络连接",icon:"none"})}}):uni.showToast({title:"请先登录",icon:"none"})},switchTab(e){this.currentTab=e}}},[["render",function(t,n,a,i,s,o){const r=e.resolveComponent("navbar"),l=e.resolveComponent("image-viewer");return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createVNode(r,{username:s.username,onLogout:o.logout},null,8,["username","onLogout"]),e.createElementVNode("view",{class:"tabs"},[e.createElementVNode("view",{class:e.normalizeClass(["tab",{active:"baoxiu"===s.currentTab}]),onClick:n[0]||(n[0]=e=>o.switchTab("baoxiu"))}," 报修明细 ",2),e.createElementVNode("view",{class:e.normalizeClass(["tab",{active:"weixiu"===s.currentTab}]),onClick:n[1]||(n[1]=e=>o.switchTab("weixiu"))}," 维修明细 ",2)]),"baoxiu"===s.currentTab?(e.openBlock(),e.createElementBlock("view",{key:0,class:"content"},[e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"报修单号:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.docnum),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"资产编号:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.AssetsCode),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"资产名称:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.AssetsName),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"使用部门:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.UserDep),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"资产类型:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.AssetsType),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"完工日期:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.FinishDate),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"故障描述:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.Discription),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"相关相片:")]),s.detail.FilesList&&s.detail.FilesList.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"image-preview"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.detail.FilesList,((t,n)=>(e.openBlock(),e.createElementBlock("view",{key:n},[e.createElementVNode("image",{src:t,mode:"aspectFit",class:"image",onClick:e=>o.openImageViewer(t)},null,8,["src","onClick"])])))),128))])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"no-images"},"暂无相关图片"))])):e.createCommentVNode("",!0),"weixiu"===s.currentTab?(e.openBlock(),e.createElementBlock("view",{key:1,class:"content"},[e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"维修单号:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.wxdocnum),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"原因分析:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.Reason),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"维修方案:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.SchemeTxt),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"预计金额:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.Amount),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"币别:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.Currency),1)])])):e.createCommentVNode("",!0),e.createVNode(l,{visible:s.isImageViewerVisible,"current-image":s.selectedImageUrl,"on-close":o.closeImageViewer},null,8,["visible","current-image","on-close"])])}],["__scopeId","data-v-5161a5ca"]]);const m=n({components:{Navbar:i},data:()=>({username:"",detail:{}}),onLoad(e){const t=uni.getStorageSync("userInfo");t&&t.username&&(this.username=t.username),this.fetchDetail(e.docnum)},methods:{logout(){uni.removeStorageSync("userInfo"),uni.redirectTo({url:"/pages/login/login"})},fetchDetail(e){const n=uni.getStorageSync("userInfo");n.token&&n.connid?uni.request({url:"http://13.94.38.44:8000/AssetsRepair/GetMainListDetail",method:"POST",header:{"content-type":"application/json"},data:JSON.stringify({connid:n.connid,token:n.token,docnum:e}),success:e=>{let n;try{n="string"==typeof e.data?JSON.parse(e.data):e.data}catch(a){return t("error","at pages/weixiuMingxi/weixiuMingxi.vue:85","解析响应数据失败:",a),void uni.showToast({title:"解析数据失败",icon:"none"})}t("log","at pages/weixiuMingxi/weixiuMingxi.vue:93",n),n.isError?uni.showToast({title:"获取详细信息失败",icon:"none"}):this.detail=n},fail:()=>{uni.showToast({title:"请求失败，请检查网络连接",icon:"none"})}}):uni.showToast({title:"请先登录",icon:"none"})}}},[["render",function(t,n,a,i,s,o){const r=e.resolveComponent("navbar");return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createVNode(r,{username:s.username,onLogout:o.logout},null,8,["username","onLogout"]),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"维修单号:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.wxdocnum),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"原因分析:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.Reason),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"维修方案:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.SchemeTxt),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"预计金额:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.Amount),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("strong",null,"币别:"),e.createElementVNode("view",{class:"xinxi"},e.toDisplayString(s.detail.Currency),1)])])])}],["__scopeId","data-v-514cae97"]]);__definePage("pages/login/login",a),__definePage("pages/home/home",s),__definePage("pages/repair/repair",o),__definePage("pages/copy/copy",l),__definePage("pages/mobileRepair/mobileRepair",c),__definePage("pages/repairList/repairList",d),__definePage("pages/baoxiuMIngxi/baoxiuMIngxi",u),__definePage("pages/weixiuMingxi/weixiuMingxi",m);const p={onLaunch:function(){t("log","at App.vue:4","App Launch")},onShow:function(){t("log","at App.vue:7","App Show")},onHide:function(){t("log","at App.vue:10","App Hide")}};const{app:g,Vuex:h,Pinia:v}={app:e.createVueApp(p)};uni.Vuex=h,uni.Pinia=v,g.provide("__globalStyles",__uniConfig.styles),g._component.mpType="app",g._component.render=()=>{},g.mount("#app")}(Vue);
